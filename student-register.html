// JavaScript to generate and manage the form

document.body.innerHTML = `
  <div id="form-container" style="max-width: 500px; margin: auto;">
    <h2>Student Registration Form</h2>
    <form id="registration-form">
      <div id="section-1">
        <h3>Personal Information</h3>
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" required><br>
        
        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" required><br>

        <label for="class">Class:</label>
        <select id="class" required>
          <option value="Senior 1">Senior 1</option>
          <option value="Senior 2">Senior 2</option>
        </select><br>
        
        <button type="button" onclick="nextSection(2)">Next</button>
      </div>

      <div id="section-2" style="display:none;">
        <h3>Guardian Information</h3>
        <label for="fatherName">Father's Name:</label>
        <input type="text" id="fatherName"><br>
        
        <label for="fatherStatus">Father's Status:</label>
        <select id="fatherStatus">
          <option value="Alive">Alive</option>
          <option value="Deceased">Deceased</option>
        </select><br>

        <label for="motherName">Mother's Name:</label>
        <input type="text" id="motherName"><br>
        
        <label for="motherStatus">Mother's Status:</label>
        <select id="motherStatus">
          <option value="Alive">Alive</option>
          <option value="Deceased">Deceased</option>
        </select><br>

        <button type="button" onclick="nextSection(1)">Previous</button>
        <button type="button" onclick="nextSection(3)">Next</button>
      </div>

      <div id="section-3" style="display:none;">
        <h3>Health Information</h3>
        <label for="allergies">Allergies:</label>
        <input type="text" id="allergies"><br>

        <label for="healthConditions">Health Conditions:</label>
        <input type="text" id="healthConditions"><br>

        <button type="button" onclick="nextSection(2)">Previous</button>
        <button type="button" onclick="submitForm()">Submit</button>
      </div>
    </form>
    <div id="message"></div>
  </div>
`;

// Navigation between sections
function nextSection(sectionNumber) {
  document.getElementById('section-1').style.display = sectionNumber === 1 ? 'block' : 'none';
  document.getElementById('section-2').style.display = sectionNumber === 2 ? 'block' : 'none';
  document.getElementById('section-3').style.display = sectionNumber === 3 ? 'block' : 'none';
}

// Function to submit the form data to Supabase
async function submitForm() {
  const formData = {
    firstName: document.getElementById("firstName").value,
    lastName: document.getElementById("lastName").value,
    class: document.getElementById("class").value,
    fatherName: document.getElementById("fatherName").value,
    fatherStatus: document.getElementById("fatherStatus").value,
    motherName: document.getElementById("motherName").value,
    motherStatus: document.getElementById("motherStatus").value,
    allergies: document.getElementById("allergies").value,
    healthConditions: document.getElementById("healthConditions").value
  };

  const SUPABASE_URL = "YOUR_SUPABASE_URL";
  const SUPABASE_API_KEY = "YOUR_SUPABASE_API_KEY";

  try {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/students`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "apikey": SUPABASE_API_KEY,
        "Authorization": `Bearer ${SUPABASE_API_KEY}`
      },
      body: JSON.stringify(formData)
    });

    if (response.ok) {
      document.getElementById("message").innerText = "Form submitted successfully!";
    } else {
      document.getElementById("message").innerText = "Failed to submit form.";
    }
  } catch (error) {
    console.error("Error:", error);
    document.getElementById("message").innerText = "Error submitting form.";
  }
}
